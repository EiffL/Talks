<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>
      A Review of The Impact of Deep Learning on the Analysis of Cosmological Galaxy Surveys
    </title>

    <meta name="description" content="GDR CoPhy Kick-off , Jan. 2023, Paris" />
    <link rel="stylesheet" href="reveal.js/dist/reset.css" />
    <link rel="stylesheet" href="reveal.js/dist/reveal.css" />
    <link
      rel="stylesheet"
      href="reveal.js/dist/theme/darkenergy.css"
      id="theme"
    />

    <!-- Theme used for syntax highlighted code -->
    <link
      rel="stylesheet"
      href="reveal.js/plugin/highlight/monokai.css"
      id="highlight-theme"
    />
  </head>

  <body>
    <div class="reveal">
      <div class="slides">

        <section data-background-iframe="background.html">
          <div class="container">
            <div
              class="title"
              style="border-radius: 20px; background-color: rgba(0, 0, 0, 0.4)"
            >
              <h1>
                A Review of The Impact of Deep Learning on the Analysis of Cosmological Galaxy Surveys
              </h1>
            </div>
          </div>
          
          <hr />
          <div style="border-radius: 20px; background-color: rgba(0, 0, 0, 0)">
            <div class="container">
              <div class="col">
                <div align="left" style="margin-left: 20px">
                  <h2>Fran√ßois Lanusse</h2>
                  <h3>in collaboration with Marc Huertas-Company</h3>
                  <br />
                  <img src="/talks/assets/CosmoStatDarkBK.png" class="plain" />
                  <br />
                </div>
              </div>

              <div class="col">
                <br />
                <br />
                <br />
                <br />
                <img
                  src="/talks/assets/logo_cnrs.png"
                  class="plain"
                  height="150"
                />
              </div>

              <div class="col">
                <a href="https://arxiv.org/abs/2210.01813"
            ><img
              src="https://img.shields.io/badge/astro--ph.IM-arXiv%3A2210.01813-B31B1B.svg"
              class="plain"
              style="height: 25px" /></a
          >
                <br />
                <br />
                <br />
                <img src="/talks/assets/aim.png" class="plain" height="150" />
              </div>
            </div>
            <div>
              slides at
              <a href="https://eiffl.github.io/talks/CoPhy2023"
                >eiffl.github.io/talks/CoPhy2023</a
              >
            </div>
          </div>
        </section>

        <section>
          <h3 class="slide-title">
            The Deep Learning Boom in Astrophysics
          </h3>

          <div class="container">
            <canvas data-chart="bar">
              <!--
						{
						 "data": {
							"labels": ["2012", "2013", "2014","2015", "2016" ,"2017", "2018", "2019", "2020", "2021", "2022"],
							"datasets": [
							 {
								"data":[ 21, 15, 17, 22, 31, 71, 113, 231, 322, 422, 537 ],
								"label":"Deep Learning || CNN || Neural Network ","backgroundColor":"#A63446"
							}
							]
						 },
						 "options": { "responsive": "true",
					"scales": {
							"yAxes": [{
									"type": "linear"
							}]
					}
						}
						}
						--> </canvas
            ><br />
          </div>
          <div>
            <b>astro-ph</b> abstracts mentioning <b>Deep Learning</b>,
            <b>CNN</b>, or <b>Neural Networks</b>
          </div>
        </section>

        <section class="inverted" data-background="#000">
          <h2>
            Will AI Revolutionize the Scientific Analysis of Cosmological
            Surveys?
          </h2>
          <!-- <img class="fragment" data-src="/talks/assets/AI_on_AI_inv.png" /> -->
        </section>

        <section>
          <h3 class="slide-title">
            Review of the impact of Deep Learning in Galaxy Survey Science
          </h3>
          <img data-src="/talks/assets/dawes.png" />
          <a href="https://arxiv.org/abs/2210.01813"
            ><img
              src="https://img.shields.io/badge/astro--ph.IM-arXiv%3A2210.01813-B31B1B.svg"
              class="plain"
              style="height: 25px" /></a
          ><br />
          <a href="https://ml4astro.github.io/dawes-review"
            >https://ml4astro.github.io/dawes-review</a
          >
        </section>

        <section>
          <h3 class="slide-title">outline of this talk</h3>

          <br />
          <br />
          <br />
          <br />

          <b>My goal for today</b>: a tour of promising and emerging ideas at
          the
          <b class="alert"
            >intersection between cosmology, numerical simulations, deep
            learning.</b
          >

          <br />
          <br />
          <br />
          <br />
          <ul>
            <li class="fragment grow">
              Interpreting Increasingly Complex Images
            </li>
            <br />
            <li class="fragment grow">
              Accelerating Numerical Simulations
            </li>
            <br />
            <li class="fragment grow">
              Enabling Implicit Inference
            </li>
          </ul>

          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
        </section>


        <section>
          <h2>Interpreting Increasingly Complex Images</h2>
          <hr />
        </section>

        <section>
          <section
            data-transition="fade-in fade-out"
            data-background="/talks/assets/gal_sdss.png"
            data-vertical-align-top
          >
            <p>Previous generation survey: SDSS</p>
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <div style="float: right; font-size: 20px">
              Image credit: Peter Melchior
            </div>
          </section>
          <section
            data-transition="fade-in fade-out"
            data-background="/talks/assets/gal_des.png"
            data-vertical-align-top
          >
            <p>Current generation survey: DES</p>
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <div style="float: right; font-size: 20px">
              Image credit: Peter Melchior
            </div>
          </section>
          <section
            data-transition="fade-in fade-out"
            data-background="/talks/assets/gal_hsc.png"
            data-vertical-align-top
          >
            <p>LSST precursor survey: HSC</p>
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <div style="float: right; font-size: 20px">
              Image credit: Peter Melchior
            </div>
          </section>
        </section>



        <section>
          <section data-background="/talks/assets/fig1.png">
            <div style="float:right; font-size: 20px">Credit: NAOJ</div>
            <h3 class="slide-title" style="background-color: rgba(0, 0, 0, 0.4);"> Detection and Classification of Astronomical Objects</h3>
    
            <br> <br> <br> <br> <br>
            <br> <br> <br> <br> <br>
            <br> <br> <br> <br> <br>
            <br> <br> <br> <br> <br>
            <br> <br> <br> <br> <br>
            <br> <br> <br> <br> <br>
          </section>
    
          <section>
            <h3 class="slide-title">A perfect task for Deep Learning</h3>
    
            <div class="container">
              <div class="col">
                <img height="550px"  data-src="/talks/assets/deeplens.png" class="plain">
                <br>
                CMUDeepLens Architecture<br> (Lanusse et al. 2017)
              </div>
    
              <div class="col">
                  <div class="container" style="position:relative; width:600px; height:500px; margin:0 auto;">
                    <div class="fragment current-visible" style="position:absolute;top:0;left:0;height:500px;" data-fragment-index="0">
                      <img height=200 data-src="/talks/assets/candidates.png" class="plain">
                      <br>Simulated gravitational lenses used for training<br>
                      <div>
                        <img data-src="/talks/assets/roc_ground_small.png" class="plain" style="height: 250px;"></img>
          
                        <br>
                        <div> <b class="alert">Better accuracy than human visual inspection!</b></div>
                      </div>
                    </div>
                    <div class="fragment" style="position:absolute;top:0;left:0;height:500px;" data-fragment-index="1">
                      <img height=450 data-src="/talks/assets/huang2019.png" data-fragment-index="1" ></img>
                      <div style="float:center; font-size: 20px">Huang et al. (2019) - arXiv:1906.00970</div>
                    </div>
    
                  </div>
                <br>
                <ul>
                <li class="fragment">This works great, as long as you do not care too much about <b class="alert">which</b> lenses are identified and <b class="alert">why</b>
                </li>
                </ul>
              </div>
            </div>
          </section>
        </section>
        
         <section>
          <section>
            <h3 class="slide-title"> Inferring Object Properties </h3>


					<div class='container'>
						<div class='col'>
							<ul>
								<li class="fragment" data-fragment-index="0"> <b>Classifying objects</b> <br>
									<div style="font-size: smaller;"><a href="https://arxiv.org/abs/1905.07424">Galaxy Zoo: Probabilistic Morphology through Bayesian CNNs and Active Learning,Walmsley et al. 2019</a>
									</div>
								</li>

								<li class="fragment" data-fragment-index="1"> <b>Inferring object properties</b> <br>
									<div style="font-size: smaller;"><a href="https://arxiv.org/abs/1806.06607">Photometric redshifts from SDSS images using a Convolutional
Neural Network, Pasquet et al. 2018</a>
									</div>
						   	</li>


								<li class="fragment" data-fragment-index="2"> <b>Self-supervised Representation Learning</b> <br>
									<div style="font-size: smaller;"><a href="https://arxiv.org/abs/2110.13151">Self-supervised similarity search for large scientific datasets, Stein et al. 2021</a>
									</div>
								</li>


								<li class="fragment" data-fragment-index="3"> <b>Solve inverse problems</b> <br>
									<div style="font-size: smaller;"><a href="https://arxiv.org/abs/2201.05561">Probabilistic Mass Mapping with Neural Score Estimation, Remy et al. 2022</a> </div>
								</li>


								<li class="fragment" data-fragment-index="4"> <b>Emulate costly physical models</b> <br>
									<div style="font-size: smaller;"><a href="https://arxiv.org/abs/1911.11778">SPECULATOR: Emulating stellar population synthesis for fast and accurate galaxy spectra and photometry, Alsing et al. 2020</a>  </div>
								</li>


								<li class="fragment" data-fragment-index="5"> <b>Accelerating numerical simulations</b> <br>
									<div style="font-size: smaller;"><a href="https://arxiv.org/abs/2010.06608"> AI-assisted super-resolution cosmological simulations, Li et al. 2021</a>
								</li>


								<li class="fragment" data-fragment-index="6"> <b>Enabling Simulation-Based Inference</b> <br>
									<div style="font-size: smaller;"><a href="https://arxiv.org/abs/2009.08459">Likelihood-free inference with neural compression of DES SV weak lensing map statistics, Jeffrey et. al 2021</a> </div>
								</li>

							</ul>
						</div>

						<div class='col'>
							<div style="position:relative; width:600px; height:600px; margin:0 auto;">
								<img class="fragment current-visible plain" data-src="/talks/assets/walmsley2019.png" style="position:absolute;top:0;left:0;width:600px;" data-fragment-index="0" />
								<img class="fragment current-visible plain" data-src="/talks/assets/Pasquet2018.png" style="position:absolute;top:0;left:0;width:600px;" data-fragment-index="1" />
								<img class="fragment current-visible plain" data-src="/talks/assets/Stein2021.png" style="position:absolute;top:0;left:0;width:600px;" data-fragment-index="2" />
								<img class="fragment current-visible plain" data-src="/talks/assets/cropped.gif" style="position:absolute;top:0;left:0;width:600px;" data-fragment-index="3" />
								<img class="fragment current-visible plain" data-src="/talks/assets/Alsing2020.png" style="position:absolute;top:0;left:0;width:600px;" data-fragment-index="4" />
								<img class="fragment current-visible plain" data-src="/talks/assets/li2020.png" style="position:absolute;top:0;left:0;width:600px;" data-fragment-index="5" />
								<img class="fragment plain" data-src="/talks/assets/jeffrey_s8.png" style="position:absolute;top:0;left:0;width:600px;" data-fragment-index="6" />
							</div>
						</div>
					</div>
          </section>
          </section>

          <section>
            <h3 class="slide-title">takeways</h3>

          </section>


        <section>
          <h2>Accelerating Cosmological Simulations with Deep Learning</h2>
          <hr />
        </section>

        <section>
          <section>
            <h3 class="slide-title">
              AI-assisted superresolution cosmological simulations
            </h3>
            <div class="container">
              <div class="col">
                <div style="float: right; font-size: 20px">
                  Li, Ni, Croft, Di Matteo, Bird, Feng (2021)
                  <a href="https://arxiv.org/abs/2010.06608"
                    ><img
                      src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2010.06608-B31B1B.svg"
                      class="plain"
                      style="height: 25px; vertical-align: middle"
                  /></a>
                </div>
              </div>
            </div>

            <div class="container">
              <div class="col">
                <img
                  class="plain"
                  data-src="/talks/assets/yin_sr.png"
                  style="width: 1000px"
                />
                <br />
                x8 super-resolution
              </div>
              <div class="col fragment" data-fragment-index="1">
                <img
                  class="plain"
                  data-src="/talks/assets/yin_nn.png"
                  style="width: 500px"
                /><br />
              </div>
            </div>
            <ul class="fragment" data-fragment-index="1">
              <li>
                Inputs low resolution
                <b class="alert">particle displacement field</b>, outputs
                samples from a
                <b class="alert">distribution $p_\theta(x_{SR} | x_{LR})$</b>
              </li>
            </ul>
          </section>

          <section
            data-background="/talks/assets/yin_large_sr.jpg"
            data-background-size="contain"
          >
            <div class="r-stack">
              <img
                class="plain fragment"
                data-src="/talks/assets/yin_ps.png"
                style="width: 1800px; background-color: #111"
              /><br />
              <img
                class="plain fragment"
                data-src="/talks/assets/yin_hmf.png"
                style="width: 1800px; background-color: #111"
              />
            </div>
          </section>
        </section>

        <section>
          <section>
            <h3 class="slide-title">
              Fast, high-fidelity Lyman Œ± forests with CNNs
            </h3>
            <div style="float: right; font-size: 20px">
              Harrington, Mustafa, Dornfest, Horowitz, Lukiƒá (2021)
              <a href="https://arxiv.org/abs/2106.12662"
                ><img
                  src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2106.12662-B31B1B.svg"
                  class="plain"
                  style="height: 25px; vertical-align: middle"
              /></a>
            </div>

            <img data-src="/talks/assets/harrington_fig1.png" />
          </section>
          <section>
            <img
              data-src="/talks/assets/harrington_fig2.png"
              style="height: 700px"
            />
          </section>
        </section>

        <section>
          <section>
            <h3 class="slide-title">
              are these Deep Learning models a real game-changer?
            </h3>

            <div class="r-stack">
              <div>
                <div class="block fragment" data-fragment-index="1">
                  <div class="block-title">
                    The Limitations of Black-Box Large Deep Learning Approaches
                  </div>
                  <div class="block-content">
                    <ul>
                      <li class="fragment" data-fragment-index="1">
                        There is a risk that a large Deep Learning model can
                        silently fail. <br />
                        $\Rightarrow$
                        <b class="alert"
                          >How can we build confidence in the output of the
                          neural network?</b
                        >
                      </li>

                      <br />

                      <li class="fragment">
                        Training these models can require a very large number of
                        simulations. <br />$\Rightarrow$
                        <b class="alert">
                          Do they bring a net computational benefit?</b
                        >
                        <ul>
                          <li class="fragment">
                            In case of the super-resolution model of
                            <b>Li et al. (2021), only 16 full-resolution</b>
                            $512^3$ N-body were necessary.
                          </li>
                        </ul>
                      </li>
                      <br />

                      <li class="fragment">
                        In many cases, the accuracy (not the quantity) of
                        simulations will be the main bottleneck. <br />
                        $\Rightarrow$
                        <b class="alert"
                          >What new science are these deep learning models
                          enabling?</b
                        >
                        <ul>
                          <li>
                            In the case of cosmological SBI, they do not help us
                            resolve the uncertainty on the simulation model.
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <br />
              <div class="fragment current-visible" data-fragment-index="2">
                <img
                  data-src="/talks/assets/harrington_fig3.png"
                  style="height: 550px"
                /><br />
                <div style="float: right; font-size: 20px">
                  (Harrington et al. 2021)
                </div>
              </div>
            </div>
          </section>
          <section>
            <div class="block">
              <div class="block-title" style="color: aquamarine">
                What Would be Desirable Properties of robust ML-based Emulation
                Methods?
              </div>
              <div class="block-content">
                <ul>
                  <li class="fragment">
                    Make use of <b>known symmetries</b> and physical
                    constraints.
                  </li>
                  <br />
                  <li class="fragment">
                    <b>Modeling residuals</b> to an approximate physical model
                  </li>
                  <br />
                  <li class="fragment">
                    <b>Minimally parametric</b>
                    <ul>
                      <li>
                        Can be trained with a very small number of simulations
                      </li>
                      <li>
                        Could potentially be
                        <b style="color: aquamarine">inferred from data!</b>
                      </li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </section>
        </section>

        <section>
          <section>
            <h3 class="slide-title">
              Learning effective physical laws for generating cosmological
              hydrodynamics with Lagrangian Deep Learning
            </h3>
            <div class="container">
              <div class="col">
                <div style="float: right; font-size: 20px">
                  Dai & Seljak (2021)
                  <a href="https://arxiv.org/abs/2010.02926"
                    ><img
                      src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2010.02926-B31B1B.svg"
                      class="plain"
                      style="height: 25px; vertical-align: middle"
                  /></a>
                </div>
              </div>
            </div>

            <div class="container">
              <div class="col">
                <ul>
                  <li>
                    The Lagrangian Deep Learning approach:
                    <ul>
                      <li class="fragment">
                        Run an approximate Particle-Mesh DM simulation (about 10
                        steps)
                      </li>

                      <li class="fragment">
                        Introduce a displacement $\mathbf{S}$ of particles:
                        \begin{equation} \mathbf{S}=-\alpha\nabla \hat{O}_{G}
                        f(\delta) \end{equation} where $\hat{O}_{g}$ is a
                        parametric Fourier-space filter, $f$ is a parametric
                        function of $\delta$. <br />$\Rightarrow$ Respects
                        translational and rotational symmetries.
                      </li>

                      <li class="fragment">
                        Apply a non-linear function on the resulting density
                        field $\delta^\prime$: $$F(x) = \mathrm{ReLu}(b_1
                        f(\delta^\prime) - b_0)$$
                      </li>
                    </ul>
                  </li>
                </ul>
              </div>

              <div class="col">
                <img
                  data-src="/talks/assets/pot_pgd.png"
                  class="plain"
                  style="height: 450px; width: 800px"
                />
                <div style="float: right; font-size: 20px">
                  <a
                    href=" https://iopscience.iop.org/article/10.1088/1475-7516/2018/11/009/pdf?casa_token=3b8_RUCo4uAAAAAA:aqUgqZUFV1jao2LlJSqI25p2GEh-2KmGTS_ab4p1F9TSK5d0SytTPG6rN_YRhKYdnd9lBiX32A:"
                    >(Dai et al. 2018)</a
                  >
                </div>
              </div>
            </div>

            <div class="fragment">
              $\Longrightarrow$ Only need to fit <b>~10 parameters</b> to
              reproduce a desired field from an hydrodynamical field.
            </div>
          </section>

          <section>
            <div class="r-stack">
              <img data-src="/talks/assets/LDL_dm.png" />
              <img class="fragment" data-src="/talks/assets/LDL_stars.png" />
              <img class="fragment" data-src="/talks/assets/LDL_tsz.png" />
            </div>
          </section>
        </section>

        <section>
          <h3 class="slide-title">takeaways</h3>
          <ul>
            <li>
              Deep Learning may allow us to
              <b>scale up existing simulation suites</b> (with caveats), but it
              is not replacing simulation codes.
            </li>

            <br />
            <li>
              One exciting prospect rarely explored so far in astrophysics is
              using Deep Learning to <b>accelerate the N-body/hydro solver</b>.
            </li>
          </ul>

          <iframe
            src="https://drive.google.com/file/d/1zFETkr3VbRZb3EYzMvypR1AtRUu-O3UZ/preview"
            width="640"
            height="480"
            allow="autoplay"
          ></iframe
          ><br />
          <div style="float: right; font-size: 20px">
            <a href="https://sites.google.com/view/meshgraphnets"
              >https://sites.google.com/view/meshgraphnets</a
            >
            (Pfaff et al. 2021)
          </div>
          <br />
          <br />
          <br />
        </section>

        <section>
          <h2>Simulation-Based Cosmological Inference</h2>
          <hr />
        </section>

        <section>
          <section>
            <h3 class="slide-title">
              the limits of traditional cosmological inference
            </h3>
            <div class="container">
              <div class="col">
                <div
                  style="
                    position: relative;
                    width: 480px;
                    height: 30px;
                    margin: 0 auto;
                  "
                >
                  <div
                    class="fragment current-visible"
                    style="position: absolute; top: 0"
                    data-fragment-index="1"
                  >
                    HSC cosmic shear power spectrum
                  </div>
                  <div
                    class="fragment"
                    style="position: absolute; top: 0"
                    data-fragment-index="2"
                  >
                    HSC Y1 constraints on $(S_8, \Omega_m)$
                  </div>
                </div>
                <div
                  style="
                    position: relative;
                    width: 480px;
                    height: 300px;
                    margin: 0 auto;
                  "
                >
                  <div
                    class="fragment current-visible"
                    style="position: absolute; top: 0; left: 0"
                    data-fragment-index="0"
                  >
                    <img class="plain" data-src="/talks/assets/alonso_g1.png" />
                    <img class="plain" data-src="/talks/assets/alonso_g2.png" />
                  </div>
                  <img
                    class="fragment current-visible plain"
                    data-src="/talks/assets/hsc_correlation_function.png"
                    style="position: absolute; top: 0; left: 0"
                    data-fragment-index="1"
                  />
                  <img
                    class="fragment plain"
                    data-src="/talks/assets/hsc_constraints.png"
                    style="position: absolute; top: 0; left: 0"
                    data-fragment-index="2"
                  />
                </div>
                <div
                  class="fragment"
                  data-fragment-index="1"
                  style="float: right; font-size: 20px"
                >
                  (Hikage et al. 2018)
                </div>
              </div>

              <div class="col">
                <ul>
                  <li class="fragment" data-fragment-index="0">
                    Measure the ellipticity $\epsilon = \epsilon_i + \gamma$ of
                    all galaxies<br />
                    $\Longrightarrow$ Noisy tracer of the weak lensing shear
                    $\gamma$
                  </li>
                  <br />
                  <li class="fragment" data-fragment-index="1">
                    Compute <b class="alert">summary statistics</b> based on 2pt
                    functions, <br />e.g. the <b>power spectrum</b>
                  </li>
                  <br />
                  <li class="fragment" data-fragment-index="2">
                    Run an MCMC to recover a posterior on model parameters,
                    using an <b class="alert">analytic likelihood</b>
                    $$ p(\theta | x ) \propto \underbrace{p(x |
                    \theta)}_{\mathrm{likelihood}} \
                    \underbrace{p(\theta)}_{\mathrm{prior}}$$
                  </li>
                </ul>
              </div>
            </div>

            <div class="block fragment">
              <div class="block-title">
                Main limitation: the need for an explicit likelihood
              </div>
              <div class="block-content">
                We can only compute the likelihood for
                <b class="alert">simple summary statistics</b> and on
                <b class="alert">large scales</b>
                <br />
                <br />
                <div class="fragment">
                  $\Longrightarrow$ We are dismissing a significant fraction of
                  the information!
                </div>
              </div>
            </div>
          </section>

          <section>
            <h3 class="slide-title">A different road: forward modeling</h3>

            <div class="container">
              <div class="col">
                <ul>
                  <li>
                    Instead of trying to analytically evaluate the likelihood
                    $p(x | \theta)$, let us build a forward model of the
                    observables.<br />
                    $\Longrightarrow$
                    <b class="alert">The simulator becomes the physical model</b
                    >.
                  </li>
                  <br />
                  <li class="fragment" data-fragment-index="1">
                    Each component of the model is now tractable, but at the
                    cost of a <b>large number of latent variables</b>.
                  </li>
                </ul>

                <br />
                <br />

                <div class="block fragment">
                  <div class="block-title">
                    Benefits of a forward modeling approach
                  </div>
                  <div class="block-content">
                    <ul>
                      <li>
                        Fully exploits the information content of the data (aka
                        "full field inference").
                      </li>

                      <br />
                      <li>Easy to incorporate systematic effects.</li>
                      <br />
                      <li>
                        Easy to combine multiple cosmological probes by joint
                        simulations.
                      </li>
                    </ul>
                  </div>
                </div>
              </div>

              <div class="col">
                <div
                  style="
                    position: relative;
                    width: 600px;
                    height: 600px;
                    margin: 0 auto;
                  "
                >
                  <img
                    class="fragment current-visible plain"
                    data-src="/talks/assets/forward_model.png"
                    style="position: absolute; top: 0; left: 0; width: 600px"
                    data-fragment-index="0"
                  />
                  <img
                    class="fragment plain"
                    data-src="/talks/assets/pgm_lensing.png"
                    style="position: absolute; top: 0; left: 0; width: 500px"
                    data-fragment-index="1"
                  />
                  <div
                    class="fragment"
                    data-fragment-index="1"
                    style="float: right; font-size: 20px"
                  >
                    (Schneider et al. 2015)
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section>
            <h3 class="slide-title">...so why is this not mainstream?</h3>
            <img
              class="plain"
              data-src="/talks/assets/lfi_sim.png"
              style="width: 1000px"
            />

            <div class="r-stack">
              <img
                class="plain fragment"
                data-src="/talks/assets/plot_massive_nu.png"
                style="width: 1000px"
              />

              <div class="block fragment">
                <div class="block-title">
                  The Challenge of Simulation-Based Inference
                </div>
                <div class="block-content">
                  $$ p(x|\theta) = \int p(x, z | \theta) dz = \int p(x | z,
                  \theta) p(z | \theta) dz $$ Where $z$ are
                  <b>stochastic latent variables</b> of the simulator.<br /><br />
                  $\Longrightarrow$ This
                  <b class="alert">marginal likelihood is intractable</b>! Hence
                  the phrase <b>"Likelihood-Free Inference"</b>
                </div>
              </div>
            </div>
          </section>
        </section>

        <section class="inverted" data-background="#000">
          <h2>
            How to do inference without evaluating the likelihood of the model?
          </h2>
        </section>

        <section>
          <section>
            <h3 class="slide-title">
              Black-box Simulators Define Implicit Distributions
            </h3>
            <img
              class="plain"
              data-src="/talks/assets/lfi_sim.png"
              style="width: 750px"
            />
            <ul>
              <li>
                A black-box simulator
                <b class="alert"
                  >defines $p(x | \theta)$ as an implicit distribution</b
                >, you can <b>sample from it</b> but you cannot evaluate it.
              </li>
              <li class="fragment">
                <b class="alert">Key Idea</b>: Use a
                <b
                  >parametric distribution model $\mathbb{P}_\varphi$ to
                  approximate the implicit distribution $\mathbb{P}$</b
                >.
              </li>
            </ul>

            <div class="container">
              <div class="col fragment fade-up">
                <img
                  data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/866922/images/7756538/pasted-from-clipboard.png"
                  class="plain"
                />
                <br />
                True $\mathbb{P}$
              </div>

              <div class="col fragment fade-up">
                <img
                  data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/866922/images/7756539/pasted-from-clipboard.png"
                  class="plain"
                />
                <br />
                Samples $x_i \sim \mathbb{P}$
              </div>

              <div class="col fragment fade-up">
                <img
                  data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/866922/images/7756554/pasted-from-clipboard.png"
                  class="plain"
                />
                <br />
                Model $\mathbb{P}_\varphi$
              </div>
            </div>
          </section>

          <section>
            <h3 class="slide-title">
              Conditional Density Estimation with Neural Networks
            </h3>
            <ul>
              <li class="fragment fade-up">
                I assume a forward model of the observations: \begin{equation}
                p( x ) = p(x | \theta) \ p(\theta) \nonumber \end{equation} All
                I ask is the ability to sample from the model, to obtain
                $\mathcal{D} = \{x_i, \theta_i \}_{i\in \mathbb{N}}$
              </li>
              <br />
              <li class="fragment fade-up">
                I am going to assume $q_\phi(\theta | x)$ a
                <b>parametric conditional density</b>
              </li>
              <br />
              <li class="fragment fade-up">
                Optimize the parameters $\phi$ of $q_{\phi}$ according to
                \begin{equation} \min\limits_{\phi} \sum\limits_{i} - \log
                q_{\phi}(\theta_i | x_i) \nonumber \end{equation} In the limit
                of <b>large number of samples</b> and
                <b>sufficient flexibility</b>
                \begin{equation} \boxed{q_{\phi^\ast}(\theta | x) \approx
                p(\theta | x)} \nonumber \end{equation}
              </li>
            </ul>

            <div style="position: relative; height: 30px; margin-left: 4em">
              <div
                class="fragment current-visible"
                style="position: absolute; top: 0"
              >
                $\Longrightarrow$ One can asymptotically recover the posterior
                by optimizing a <b>parametric estimator</b> over<br />
                the <b>Bayesian joint distribution</b>
              </div>
              <div class="fragment" style="position: absolute; top: 0">
                $\Longrightarrow$ One can asymptotically recover the posterior
                by optimizing a
                <b class="alert">Deep Neural Network</b> over<br />
                a <b class="alert">simulated training set</b>.
              </div>
            </div>
          </section>

          <section>
            <h3 class="slide-title">Neural Density Estimation</h3>
            <div class="container">
              <div class="col r-stack">
                <div class="fragment current-visible" data-fragment-index="0">
                  <img
                    class="plain"
                    data-src="/talks/assets/MDN.png"
                    style="height: 550px"
                  />
                  <br />
                  <div style="float: left; font-size: 20px">Bishop (1994)</div>
                </div>
                <div class="fragment" data-fragment-index="1">
                  <img data-src="/talks/assets/flow_dinh_1.png" class="plain" />
                  <img data-src="/talks/assets/flow_dinh_2.png" class="plain" />
                  <br />
                  <div style="float: right; font-size: 20px">
                    Dinh et al. 2016
                  </div>
                </div>
              </div>
              <div class="col">
                <ul>
                  <li class="fragment" data-fragment-index="0">
                    Mixture Density Networks \begin{equation} p(\theta | x) =
                    \prod_i \pi_i(x) \ \mathcal{N}\left(\mu_i(x), \ \sigma_i(x)
                    \right) \nonumber \end{equation}
                  </li>
                  <br />

                  <li class="fragment fade-up" data-fragment-index="1">
                    Conditional Normalizing Flows \begin{equation} p(\theta| x)
                    = p_z \left( z = f^{-1}(\theta, x) \right) \left|
                    \frac{\partial f^{-1}(\theta, x)}{\partial x} \right|
                    \end{equation}
                  </li>
                </ul>
              </div>
            </div>
          </section>
        </section>

        <section>
          <h3 class="slide-title">A variety of algorithms</h3>
          <div style="float: right; font-size: 20px">
            Lueckmann, Boelts, Greenberg, Gon√ßalves, Macke (2021)
            <a href="https://arxiv.org/abs/2101.04653"
              ><img
                src="https://img.shields.io/badge/stat.ML-arXiv%3A2101.04653-B31B1B.svg"
                class="plain"
                style="height: 25px; vertical-align: middle"
            /></a>
          </div>
          <img class="plain" data-src="/talks/assets/sbibm_comparison.png" />

          <br />
          <br />
          A few important points:
          <br /><br />
          <ul>
            <li class="fragment">
              <b>Amortized</b> inference methods, which estimate $p(\theta |
              x)$, can greatly speed up posterior estimation once trained.
            </li>
            <br />

            <li class="fragment">
              <b>Sequential</b> Neural Posterior/Likelihood Estimation methods
              can actively sample simulations needed to refine the inference.
            </li>
          </ul>
        </section>

        <section>
          <h3 class="slide-title">Automated Summary Statistics Extraction</h3>
          <img class="plain" data-src="/talks/assets/lfi_sim_sum.png" />
          <ul>
            <li>
              Introduce a parametric function $f_\varphi$ to
              <b class="alert"
                >reduce the dimensionality of the data while preserving
                information</b
              >.
            </li>
          </ul>
          <div class="container">
            <div class="col">
              <div class="r-stack">
                <img
                  class="plain fragment current-visible"
                  data-fragment-index="0"
                  data-src="/talks/assets/mutual_information.png"
                />
                <img
                  class="plain fragment"
                  data-fragment-index="1"
                  data-src="/talks/assets/imnn.png"
                />
              </div>
              <div
                class="fragment"
                style="float: right; font-size: 15px"
                data-fragment-index="1"
              >
                Makinen, Charnock, Alsing, Wandelt (2021)
                <a href="https://arxiv.org/abs/2107.07405"
                  ><img
                    src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2107.07405-B31B1B.svg"
                    class="plain"
                    style="height: 20px; vertical-align: middle"
                /></a>
              </div>
            </div>
            <div class="col">
              <div class="block fragment" data-fragment-index="0">
                <div class="block-title">Information-based loss functions</div>
                <div class="block-content">
                  <ul>
                    <li class="fragment" data-fragment-index="0">
                      Variational Mutual Information Maximization $$ \mathcal{L}
                      \ = \ \mathbb{E}_{y, \theta} [ \log q_\phi(\theta |
                      f_\varphi(x)) ] \leq I(Y; \Theta) $$

                      <div style="float: right; font-size: 15px">
                        Jeffrey, Alsing, <b>Lanusse</b> (2021)
                        <a href="https://arxiv.org/abs/2009.08459"
                          ><img
                            src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2009.08459-B31B1B.svg"
                            class="plain"
                            style="height: 20px; vertical-align: middle"
                        /></a>
                      </div>
                    </li>
                    <br /><br />
                    <li class="fragment" data-fragment-index="1">
                      Information Maximization Neural Network $$\mathcal{L} \ =
                      \ - | \det \mathbf{F} | \ \mbox{with} \
                      \mathbf{F}_{\alpha, \beta} = tr[ \mu_{\alpha}^t C^{-1}
                      \mu_{\beta} ] $$
                      <div style="float: right; font-size: 15px">
                        Charnock, Lavaux, Wandelt (2018)
                        <a href="https://arxiv.org/abs/1802.03537"
                          ><img
                            src="https://img.shields.io/badge/astro--ph.IM-arXiv%3A1802.03537-B31B1B.svg"
                            class="plain"
                            style="height: 20px; vertical-align: middle"
                        /></a>
                      </div>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section>
          <!-- <section>
            <h3 class="slide-title">
              Example of application: Constraining Dark Matter Substructures
            </h3>
            <div class="container">
              <div class="col">
                <div style="float: right; font-size: 20px">
                  Brehmer, Mishra-Sharma, Hermans, Louppe, Cranmer (2019)
                  <a href="https://arxiv.org/abs/1909.02005"
                    ><img
                      src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A1909.02005-B31B1B.svg"
                      class="plain"
                      style="height: 25px; vertical-align: middle"
                  /></a>
                </div>
              </div>
            </div>

            <div class="r-stack">
              <img
                data-src="/talks/assets/Brehmer2019a.png"
                style="height: 500px"
              />
              <img
                class="fragment"
                data-src="/talks/assets/Brehmer2019b.png"
                style="height: 500px"
              />
              <img
                class="fragment"
                data-src="/talks/assets/Brehmer2019.gif"
                style="height: 500px"
              />
            </div>
          </section>

          <section>
            <h3 class="slide-title">
              Example of application: Infering Microlensing Event Parameters
            </h3>
            <div class="container">
              <div class="col">
                <div style="float: right; font-size: 20px">
                  Zhang, Bloom, Gaudi, <b>Lanusse</b>, Lam, Lu (2021)
                  <a href="https://arxiv.org/abs/2102.05673"
                    ><img
                      src="https://img.shields.io/badge/astro--ph.IM-arXiv%3A2102.05673-B31B1B.svg"
                      class="plain"
                      style="height: 25px; vertical-align: middle"
                  /></a>
                </div>
              </div>
            </div>
            <div class="r-stack">
              <div class="fragment current-visible">
                <img
                  data-src="/talks/assets/Zhang2021a.png"
                  style="height: 500px"
                />
              </div>

              <div class="fragment">
                <img
                  data-src="/talks/assets/Zhang2021b.png"
                  style="height: 500px"
                />
              </div>
            </div>
          </section> -->

          <section>
            <h3 class="slide-title">
              Example of application: Likelihood-Free parameter inference with
              DES SV
            </h3>
            <div class="container">
              <div class="col">
                <div style="float: right; font-size: 20px">
                  Jeffrey, Alsing, <b>Lanusse</b> (2021)
                  <a href="https://arxiv.org/abs/2009.08459"
                    ><img
                      src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2009.08459-B31B1B.svg"
                      class="plain"
                      style="height: 25px; vertical-align: middle"
                  /></a>
                </div>
              </div>
            </div>

            <div class="container">
              <div class="col">
                <img
                  class="plain"
                  data-src="/talks/assets/ks_sv.png"
                  style="height: 550px"
                />
              </div>

              <div class="col r-stack">
                <div class="fragment current-visible">
                  <img
                    class="plain"
                    data-src="/talks/assets/orthant.png"
                    style="height: 300px"
                  />
                  <img
                    class="plain"
                    data-src="/talks/assets/sim_params.png"
                    style="height: 300px"
                  /><br />
                  Suite of N-body + raytracing simulations: $\mathcal{D}$
                </div>

                <div class="fragment current-visible">
                  <img
                    class="plain"
                    data-src="/talks/assets/jeffrey_model.png"
                    style="height: 550px"
                  /><br />
                </div>

                <div class="fragment">
                  <img class="plain" data-src="/talks/assets/jeffrey_s8.png" />
                </div>
              </div>
            </div>
          </section>
        </section>

        <section>
          <h3 class="slide-title">takeways</h3>

          <ul>
            <li>
              Likelihood-Free Inference <b>automatizes inference</b> over
              numerical simulators.
              <ul>
                <li>
                  Turns both summary extraction and inference problems into an
                  <b class="alert">optimization problems</b>
                </li>
                <li><b>Deep learning allows us to solve that problem!</b></li>
              </ul>
            </li>

            <br />
            <li class="fragment">
              In the context of upcoming surveys, this techniques provides
              <b class="alert">many advantages</b>:
              <ul>
                <li>
                  <b>Amortized inference</b>: near instantaneous parameter
                  inference, extremely useful for time-domain.
                </li>
                <li>
                  <b>Optimal information extraction</b>: no longer need for
                  restrictive modeling assumptions needed to obtain tractable
                  likelihoods.
                </li>
              </ul>
            </li>
            <br />
          </ul>

          <br />
          <br />
          <div class="block fragment">
            <div class="block-title">
              Will we be able to exploit all of the information content of
              Euclid?
            </div>
            <div class="block-content">
              $\Longrightarrow$ Not rightaway, but it is not the fault of Deep
              Learning!
              <br />
              <br />
              <ul>
                <li class="fragment">
                  Deep Learning has redefined the limits of our statistical
                  tools, creating
                  <b>additional demand on the accuracy of simulations</b> far
                  beyond the power spectrum.
                </li>
                <br />
                <li class="fragment">
                  Neural compression methods have the downside of being opaque.
                  It is <b>much harder to detect unknown systematics</b>.
                </li>
                <br />
                <li class="fragment">
                  We will need a significant number of
                  <b>large volume, high resolution</b> simulations.
                </li>
              </ul>
            </div>
          </div>
          <br />

          <br />

          <br />
          <br />
        </section>


        <section>
          <h2>Conclusion</h2>
          <hr />
        </section>

        <section>
          <h3 class="slide-title">
            How do I see the future of Deep Learning and Simulation?
          </h3>

          <ul>
            <li class="fragment">
              Because Deep Learning allows us to directly use simulations for
              inference,
              <b
                >simulations will ultimately replace analytic models in most
                cosmological analysis</b
              >.
            </li>
            <br />
            <br />
            <li class="fragment">
              For this to happen, simulations need to:
              <ul>
                <li>
                  Become cheap<br />
                  $\Longrightarrow$ Deep Learning can help there
                </li>
                <br />
                <li>
                  be parameterised in terms of nuisance parameters we can vary
                  and infer from data.
                </li>

                <br />
                <li>
                  Ideally be ran dynamically as part of the inference pipeline
                </li>
              </ul>
            </li>
            <br />
            <br />
            <li class="fragment">
              Because
              <b>full-field inference with differentiable simulators</b> is so
              much more powerful, there will be an increased market for it.
              Start to invest now :-)
            </li>
          </ul>

          <br />
          <br />
          <p class="fragment">Thank you !</p>
          <br />
          <br />
        </section>
      </div>
    </div>

    <style>
      .reveal .slides {
        border: 5px solid red;
        min-height: 100%;
        width: 128mm;
        height: 96mm;
      }

      .reveal .block {
        background-color: #191919;
        margin-left: 20px;
        margin-right: 20px;
        text-align: left;
        padding-bottom: 0.1em;
      }

      .reveal .block-title {
        background-color: #333333;
        padding: 8px 35px 8px 14px;
        color: #ffaa7f;
        font-weight: bold;
      }

      .reveal .block-content {
        padding: 8px 35px 8px 14px;
      }

      .reveal .slide-title {
        border-left: 5px solid white;
        text-align: left;
        margin-left: 20px;
        padding-left: 20px;
      }

      .reveal .alert {
        color: #ffaa7f;
        font-weight: bold;
      }

      .reveal .inverted {
        filter: invert(100%);
      }
    </style>

    <script src="reveal.js/dist/reveal.js"></script>
    <script src="reveal.js/plugin/notes/notes.js"></script>
    <script src="reveal.js/plugin/markdown/markdown.js"></script>
    <script src="reveal.js/plugin/highlight/highlight.js"></script>
    <script src="reveal.js/plugin/math/math.js"></script>
    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
        controls: true,

        //center: false,
        hash: true,

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: "hidden",

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: true,

        transition: "slide", // none/fade/slide/convex/concave/zoom

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,
        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // Bounds for smallest/largest possible scale to apply to content
        minScale: 0.2,
        maxScale: 1.5,

        autoPlayMedia: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes, RevealMath],

        dependencies: [
          {
            src: "reveal.js/plugin/markdown/marked.js",
          },
          {
            src: "reveal.js/plugin/markdown/markdown.js",
          },
          {
            src: "reveal.js/plugin/notes/notes.js",
            async: true,
          },
          {
            src: "reveal.js/plugin/math/math.js",
            async: true,
          },
          {
            src: "reveal.js/plugin/reveal.js-d3/reveald3.js",
          },
          {
            src: "reveal.js/plugin/reveal.js-plugins/chart/Chart.min.js",
          },
          {
            src: "reveal.js/plugin/reveal.js-plugins/chart/csv2chart.js",
          },
          {
            src: "reveal.js/plugin/highlight/highlight.js",
            async: true,
          },
        ],
      });
    </script>
  </body>
</html>
