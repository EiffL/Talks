<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>Combining Physics and Machine Learning in Astrophysics</title>

    <meta
      name="description"
      content="BASP Conference, Feb 2023, Villars-Sur-Ollon"
    />
    <link rel="stylesheet" href="reveal.js/dist/reset.css" />
    <link rel="stylesheet" href="reveal.js/dist/reveal.css" />
    <link
      rel="stylesheet"
      href="reveal.js/dist/theme/darkenergy.css"
      id="theme"
    />

    <!-- Theme used for syntax highlighted code -->
    <link
      rel="stylesheet"
      href="reveal.js/plugin/highlight/monokai.css"
      id="highlight-theme"
    />
  </head>

  <body>
    <div class="reveal">
      <div class="slides">
        <section data-background-iframe="background.html">
          <div class="container">
            <div
              class="title"
              style="border-radius: 20px; background-color: rgba(0, 0, 0, 0.4)"
            >
              <h1>Combining Physics and Deep Learning in Astrophysics</h1>
              <h2>BASP Frontiers Conference, Villars-sur-Ollon, Feb 2023</h2>
            </div>
          </div>

          <hr />
          <div style="border-radius: 20px; background-color: rgba(0, 0, 0, 0)">
            <div class="container">
              <div class="col">
                <div align="left" style="margin-left: 20px">
                  <h2>François Lanusse</h2>
                  <br />
                  <br />
                  <br />
                  <img src="/talks/assets/CosmoStatDarkBK.png" class="plain" />
                  <br />
                </div>
              </div>

              <div class="col">
                <br />
                <br />
                <br />
                <br />
                <br />
                <img
                  src="/talks/assets/logo_cnrs.png"
                  class="plain"
                  height="150"
                />
              </div>

              <div class="col">
                <br />
                <br />
                <br />
                <img src="/talks/assets/aim.png" class="plain" height="150" />
              </div>
            </div>
            <div>
              slides at
              <a
                href="https://eiffl.github.io/talks/BASP2023"
                style="font-weight: bold; color: brown"
                >flanusse.net/talks/BASP2023</a
              >
            </div>
          </div>
        </section>

        <section>
          <section
            data-background-image="/talks/assets/WMAP_timeline_large.jpg"
          >
            <h3 class="slide-title" style="position: absolute; top: 0">
              the $\Lambda$CDM view of the Universe
            </h3>
            <br />
            <br />
            <div class="container">
              <div class="col" style="flex: 0 0 40em"></div>
              <div class="col">
                <img
                  class="plain"
                  data-src="/talks/assets/Euclid.png"
                  style="width: 240px"
                />

                <img
                  class="plain"
                  data-src="/talks/assets/roman_logo_black_w200px.png"
                  style="width: 240px"
                />

                <img
                  class="plain"
                  data-src="/talks/assets/vrro.png"
                  style="width: 240px"
                />
              </div>
            </div>
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
          </section>

          <!-- <section
            data-background-video="/talks/assets/animation-day-to-night.mov"
            data-background-video-muted
          >
            <h3 class="slide-title">
              the Rubin Observatory Legacy Survey of Space and Time
            </h3>
            <div class="container">
              <div class="col">
                <ul>
                  <li class="fragment fade-up">
                    1000 images each night, 15 TB/night for 10 years
                  </li>
                  <br />
                  <li class="fragment fade-up">
                    18,000 square degrees, observed once every few days
                  </li>
                  <br />
                  <li class="fragment fade-up">
                    Tens of billions of objects, each one observed $\sim1000$
                    times
                  </li>
                </ul>
              </div>

              <div class="col">
                <video
                  data-autoplay
                  class="fragment fade-up"
                  data-fragment-index="1"
                  data-src="/talks/assets/obsim.mp4"
                  type="video/mp4"
                />
              </div>
            </div>
          </section> -->

          <section
            data-transition="fade-in fade-out"
            data-background="/talks/assets/gal_sdss.png"
            data-vertical-align-top
          >
            <p>Previous generation survey: SDSS</p>
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <div style="float: right; font-size: 20px">
              Image credit: Peter Melchior
            </div>
          </section>
          <section
            data-transition="fade-in fade-out"
            data-background="/talks/assets/gal_des.png"
            data-vertical-align-top
          >
            <p>Current generation survey: DES</p>
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <div style="float: right; font-size: 20px">
              Image credit: Peter Melchior
            </div>
          </section>
          <section
            data-transition="fade-in fade-out"
            data-background="/talks/assets/gal_hsc.png"
            data-vertical-align-top
          >
            <p>LSST precursor survey: HSC</p>
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <br />
            <div style="float: right; font-size: 20px">
              Image credit: Peter Melchior
            </div>
          </section>

          <!-- <section>
            <h3 class="slide-title">We need to rethink all stages of data analysis</h3>

            <div class="r-stack">
              <div class="fragment current-visible" data-fragment-index="0">
                <img data-src="/talks/assets/hsc_shredded.png" style="height:400px;"/><br>
                <div class="fragment" data-fragment-index="0" style="float:right; font-size: 20px">Bosch et al. 2017</div>
              </div>

              <div class="fragment current-visible" data-fragment-index="1">
                <img data-src="/talks/assets/deepmass_sims_clean.png" style="height:400px;"/><br>
                <div class="fragment" data-fragment-index="1" style="float:right; font-size: 20px">Jeffrey, <b>Lanusse</b>, et al. 2020</div>
              </div>

              <div class="fragment" data-fragment-index="2">
                <img  data-src="/talks/assets/ScatteringTransform.png" style="height:400px;"/> <br>
                <div class="fragment" data-fragment-index="2" style="float:right; font-size: 20px">Cheng et al. 2020</div>
              </div>
            </div>
            <ul>
              <li class="fragment" data-fragment-index="0">Galaxies are no longer blobs.</li>
              <li class="fragment" data-fragment-index="1">Signals are no longer Gaussian.</li>
              <li class="fragment" data-fragment-index="2">Cosmological likelihoods are no longer tractable.</li>
            </ul>
            <br>
            <br>
            <div class="fragment">$\Longrightarrow$ This is the <b class="alert">end of the analytic era</b>...</div>
          </section> -->
        </section>

        <section>
          <section data-background="/talks/assets/gal_hsc.png">
            <h3 class="slide-title">Limitations of black-box deep learning</h3>
            <div class="fragment">
              <div class="container">
                <div style="float: right; font-size: 20px">
                  Reiman & Göhre (2018)
                  <a href="https://arxiv.org/abs/1810.10098"
                    ><img
                      src="https://img.shields.io/badge/astro--ph.IM-arXiv%3A1810.10098-B31B1B.svg"
                      class="plain"
                      style="height: 25px; vertical-align: middle"
                  /></a>
                </div>
              </div>
              <div>
                <div class="r-stack">
                  <div>
                    <img
                      class="plain"
                      data-src="/talks/assets/Reiman2018_1.png"
                    />

                    <div class="block fragment">
                      <div class="block-title">
                        The issue with using deep learning as a <i>black-box</i>
                      </div>
                      <div class="block-content">
                        <ul>
                          <li>
                            No explicit control of noise, PSF, number of
                            sources.
                            <ul>
                              <li>
                                Model would have to be retrained for all
                                observing configurations
                              </li>
                            </ul>
                          </li>
                          <li class="fragment">
                            No guarantees on the network output (e.g. flux
                            preservation, artifacts)
                          </li>
                          <li class="fragment">
                            No proper uncertainty quantification.
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>

                  <img
                    class="plain fragment"
                    data-src="/talks/assets/Reiman2018_3.png"
                  />
                </div>
              </div>
            </div>
          </section>
        </section>

        <section class="inverted" data-background="#000">
          <h2>How do we overcome these limitations?</h2>

          <br />
          <br />

          <div class="fragment">
            <h2>Physics!</h2>

            <br />
            <br />

            <ul>
              <li class="fragment grow">
                Analysing data within a
                <b class="alert">physically motivated causal model</b>
              </li>
              <br />
              <br />
              <li class="fragment grow">
                Imposing <b class="alert">physical constrains</b> on neural
                networks
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h2>Physical Deep Probabilistic Modeling</h2>
          <hr />
        </section>

        <section>
          <section>
            <h3 class="slide-title">Key concept: generative modeling</h3>
            <br />
            <ul>
              <li>
                The goal of generative modeling is to
                <b
                  >learn an <b class="alert">implicit</b> distribution
                  $\mathbb{P}$</b
                >
                from which the
                <b>training set $X = \{x_0, x_1, \ldots, x_n \}$</b> is drawn.
              </li>
              <br />
              <li class="fragment">
                Usually, this means building a parametric model
                $\mathbb{P}_\theta$ that tries to be close to $\mathbb{P}$.
              </li>
            </ul>

            <br />
            <div class="container">
              <div class="col fragment fade-up">
                <img
                  data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/866922/images/7756538/pasted-from-clipboard.png"
                  class="plain"
                />
                <br />
                True $\mathbb{P}$
              </div>

              <div class="col fragment fade-up">
                <img
                  data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/866922/images/7756539/pasted-from-clipboard.png"
                  class="plain"
                />
                <br />
                Samples $x_i \sim \mathbb{P}$
              </div>

              <div class="col fragment fade-up">
                <img
                  data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/866922/images/7756554/pasted-from-clipboard.png"
                  class="plain"
                />
                <br />
                Model $\mathbb{P}_\theta$
              </div>
            </div>
            <br />
            <br />
            <ul>
              <li class="fragment">
                Once trained, you can typically
                <b>sample from $\mathbb{P}_\theta$</b> and/or
                <b class="alert">evaluate the likelihood $p_\theta(x)$</b>.
              </li>
            </ul>
          </section>

          <section>
            <h3 class="slide-title">Why are these generative models useful?</h3>

            <b class="alert">Implicit distributions are everywhere!</b>
            <br />
            <br />
            <div class="container">
              <div class="col fragment">
                <b>Case I</b>: Examples from data, no accurate physical model<br />
                <img
                  data-src="/talks/assets/real_gal-inv-small.png"
                  style="height: 400px"
                /><br />
                <div style="float: right; font-size: 20px">
                  Mandelbaum et al. 2014
                </div>
                <br />
              </div>

              <div class="col fragment">
                <b>Case II</b>: Physical model only available as a simulator<br />
                <img
                  data-src="/talks/assets/convergence.png"
                  style="height: 400px"
                /><br />
                <div style="float: right; font-size: 20px">
                  Osato et al. 2020
                </div>
                <br />
              </div>
            </div>
            <br />
            <div class="fragment">
              $\Longrightarrow$ Generative models
              <b class="alert">will enable Bayesian inference</b> in cases where
              implicit distributions are involved, by providing a tractable
              $p_\theta(x)$.
            </div>
          </section>
        </section>

        <section>
          <section>
            <h3 class="slide-title" style="position: absolute; top: 0">
              A Physicist's approach to deconvolution
            </h3>
            <div class="container">
              <div class="col">
                <div style="float: right; font-size: 20px">
                  <b>Lanusse</b> et al. (2020)
                  <a href="https://arxiv.org/abs/2008.03833"
                    ><img
                      src="https://img.shields.io/badge/astro--ph.IM-arXiv%3A2008.03833-B31B1B.svg"
                      class="plain"
                      style="height: 25px; vertical-align: middle"
                  /></a>
                </div>
              </div>
            </div>
            <div class="container">
              <div class="col">
                <img
                  class="plain fragment"
                  data-src="/talks/assets/rand_z_square.png"
                  style="height: 150px"
                  data-fragment-index="4"
                />
              </div>
              <div class="col">
                <img
                  class="plain fragment"
                  data-src="/talks/assets/cosmos_gal.png"
                  style="width: 200px"
                  data-fragment-index="3"
                />
              </div>
              <div class="col">
                <img
                  class="plain fragment"
                  data-src="/talks/assets/cosmos_gal_psf.png"
                  style="width: 200px"
                  data-fragment-index="2"
                />
              </div>

              <div class="col">
                <img
                  class="plain fragment"
                  data-src="/talks/assets/cosmos_gal_pix.png"
                  style="width: 200px"
                  data-fragment-index="1"
                />
              </div>

              <div class="col">
                <img
                  class="plain fragment"
                  data-src="/talks/assets/cosmos_gal_ground.png"
                  style="width: 200px"
                  data-fragment-index="0"
                />
              </div>
            </div>

            <div
              class="container"
              style="
                position: relative;
                width: 1000px;
                height: 50px;
                margin: 0 auto;
              "
            >
              <div class="col fragment" data-fragment-index="4">
                <font size="10"> $\longrightarrow$ </font> <br />
                $g_\theta$
              </div>
              <div class="col fragment" data-fragment-index="3">
                <font size="10"> $\longrightarrow$ </font> <br />
                PSF
              </div>
              <div class="col fragment" data-fragment-index="2">
                <font size="10"> $\longrightarrow$ </font> <br />
                Pixelation
              </div>
              <div class="col fragment" data-fragment-index="1">
                <font size="10"> $\longrightarrow$ </font> <br />
                Noise
              </div>
            </div>

            <div class="container">
              <div class="col">
                <div
                  style="
                    position: relative;
                    width: 400px;
                    height: 300px;
                    margin: 0 auto;
                  "
                >
                  <img
                    data-src="/talks/assets/pgm_0.png"
                    class="plain fragment current-visible"
                    style="position: absolute; top: 0; left: 0; height: 300px"
                    data-fragment-index="0"
                  />
                  <img
                    data-src="/talks/assets/pgm_1.png"
                    class="plain fragment current-visible"
                    style="position: absolute; top: 0; left: 0; height: 300px"
                    data-fragment-index="1"
                  />
                  <img
                    data-src="/talks/assets/pgm_1.png"
                    class="plain fragment current-visible"
                    style="position: absolute; top: 0; left: 0; height: 350px"
                    data-fragment-index="2"
                  />
                  <img
                    data-src="/talks/assets/pgm_2.png"
                    class="plain fragment current-visible"
                    style="position: absolute; top: 0; left: 0; height: 350px"
                    data-fragment-index="3"
                  />
                  <img
                    data-src="/talks/assets/pgm_3.png"
                    class="plain fragment"
                    style="position: absolute; top: 0; left: 0; height: 300px"
                    data-fragment-index="4"
                  />
                </div>
              </div>
              <div class="col">
                <div class="block fragment" data-fragment-index="0">
                  <div class="block-title">Probabilistic model</div>
                  <div class="block-content">
                    <div
                      style="
                        position: relative;
                        width: 400px;
                        height: 100px;
                        margin: 0 auto;
                      "
                    >
                      <div
                        class="plain fragment current-visible"
                        style="
                          position: absolute;
                          top: 0;
                          left: 0;
                          width: 400px;
                        "
                        data-fragment-index="0"
                      >
                        $$ x \sim ? $$
                      </div>
                      <div
                        class="plain fragment current-visible"
                        style="
                          position: absolute;
                          top: 0;
                          left: 0;
                          width: 400px;
                        "
                        data-fragment-index="1"
                      >
                        $$ x \sim \mathcal{N}(z, \Sigma) \quad z \sim ? $$<br />latent
                        $z$ is a denoised galaxy image
                      </div>
                      <div
                        class="plain fragment current-visible"
                        style="
                          position: absolute;
                          top: 0;
                          left: 0;
                          width: 400px;
                        "
                        data-fragment-index="2"
                      >
                        $$ x \sim \mathcal{N}( \mathbf{P} z, \Sigma) \quad z
                        \sim ?$$<br />latent $z$ is a super-resolved and
                        denoised galaxy image
                      </div>
                      <div
                        class="plain fragment current-visible"
                        style="
                          position: absolute;
                          top: 0;
                          left: 0;
                          width: 400px;
                        "
                        data-fragment-index="3"
                      >
                        $$ x \sim \mathcal{N}( \mathbf{P} (\Pi \ast z), \Sigma)
                        \quad z \sim ? $$<br />latent $z$ is a deconvolved,
                        super-resolved, and denoised galaxy image
                      </div>
                      <div
                        class="plain fragment"
                        style="
                          position: absolute;
                          top: 0;
                          left: 0;
                          width: 400px;
                        "
                        data-fragment-index="4"
                      >
                        $$ x \sim \mathcal{N}( \mathbf{P} (\Pi \ast
                        g_\theta(z)), \Sigma) \quad z \sim \mathcal{N}(0,
                        \mathbf{I}) $$ <br />latent $z$ is a Gaussian sample<br />
                        <b class="alert">
                          $\theta$ are parameters of the model</b
                        >
                      </div>
                    </div>
                    <br />
                    <br />
                    <br />
                  </div>
                </div>
              </div>
            </div>
            <div class="fragment">
              $\Longrightarrow$
              <b class="alert">
                Decouples the morphology model from the observing conditions</b
              >.
            </div>
          </section>

          <section>
            <h3 class="slide-title">
              Bayesian Inference a.k.a. Uncertainty Quantification
            </h3>
            <div class="container">
              <div class="col">
                <img
                  data-src="/talks/assets/pgm.png"
                  class="plain"
                  style="height: 250px"
                />
              </div>
              <div class="col">
                The Bayesian view of the problem: $$ p(z | x ) \propto
                p_\theta(x | z, \Sigma, \mathbf{\Pi}) p(z)$$ where:
                <br />
                <ul>
                  <li>$p( z | x )$ is the <b class="alert">posterior</b></li>
                  <li>
                    $p( x | z )$ is the data likelihood,
                    <b class="alert">contains the physics</b>
                  </li>
                  <li>$p( z )$ is the <b>prior</b></li>
                </ul>
              </div>
            </div>

            <div class="container">
              <div class="col">
                <div
                  style="
                    position: relative;
                    width: 200px;
                    height: 200px;
                    margin: 0 auto;
                  "
                >
                  <img
                    class="plain fragment current-visible"
                    data-src="/talks/assets/cosmos_gal_ground.png"
                    style="position: absolute; top: 0; left: 0; width: 200px"
                    data-fragment-index="0"
                  />
                  <img
                    class="plain fragment"
                    data-src="/talks/assets/cosmos_gal.png"
                    style="position: absolute; top: 0; left: 0; width: 200px"
                    data-fragment-index="1"
                  />
                </div>
                <div
                  class="container"
                  style="
                    position: relative;
                    width: 200px;
                    height: 50px;
                    margin: 0 auto;
                  "
                >
                  <div
                    class="col fragment current-visible"
                    data-fragment-index="0"
                    style="position: absolute; top: 0; left: 0; width: 200px"
                  >
                    Data<br />
                    $x_n$
                  </div>
                  <div
                    class="col fragment"
                    data-fragment-index="1"
                    style="position: absolute; top: 0; left: 0; width: 200px"
                  >
                    Truth<br />
                    $x_0$
                  </div>
                </div>
                <br />
              </div>

              <div class="col fragment" data-fragment-index="0">
                <div
                  style="
                    position: relative;
                    width: 200px;
                    height: 200px;
                    margin: 0 auto;
                  "
                >
                  <div>
                    <video
                      data-autoplay
                      data-loop
                      data-src="/talks/assets/rec_samples.mp4"
                      type="video/mp4"
                      style="height: 200px"
                    />
                  </div>
                </div>
                <div>
                  Posterior samples<br />
                  $g_\theta(z)$
                </div>
              </div>

              <div class="col">
                <div
                  style="
                    position: relative;
                    width: 200px;
                    height: 200px;
                    margin: 0 auto;
                  "
                >
                  <div>
                    <video
                      class="fragment current-visible"
                      data-autoplay
                      data-loop
                      data-src="/talks/assets/rec_lsst.mp4"
                      type="video/mp4"
                      style="position: absolute; top: 0; left: 0; width: 200px"
                      data-fragment-index="0"
                    />
                  </div>
                  <img
                    class="plain fragment"
                    data-src="/talks/assets/rec_median.png"
                    style="position: absolute; top: 0; left: 0; width: 200px"
                    data-fragment-index="1"
                  />
                </div>

                <div
                  class="container"
                  style="
                    position: relative;
                    width: 200px;
                    height: 50px;
                    margin: 0 auto;
                  "
                >
                  <div
                    class="col fragment current-visible"
                    data-fragment-index="0"
                    style="position: absolute; top: 0; left: 0; width: 200px"
                  >
                    <br />
                    $\mathbf{P} (\Pi \ast g_\theta(z))$
                  </div>
                  <div
                    class="col fragment"
                    data-fragment-index="1"
                    style="position: absolute; top: 0; left: 0; width: 200px"
                  >
                    Median
                  </div>
                </div>
              </div>

              <div class="col">
                <div
                  style="
                    position: relative;
                    width: 200px;
                    height: 200px;
                    margin: 0 auto;
                  "
                >
                  <div>
                    <video
                      class="fragment current-visible"
                      data-autoplay
                      data-loop
                      data-src="/talks/assets/res_lsst.mp4"
                      type="video/mp4"
                      style="position: absolute; top: 0; left: 0; width: 200px"
                      data-fragment-index="0"
                    />
                  </div>
                  <img
                    class="plain fragment"
                    data-src="/talks/assets/rec_std.png"
                    style="position: absolute; top: 0; left: 0; width: 200px"
                    data-fragment-index="1"
                  />
                </div>

                <div
                  class="container"
                  style="
                    position: relative;
                    width: 200px;
                    height: 50px;
                    margin: 0 auto;
                  "
                >
                  <div
                    class="col fragment current-visible"
                    data-fragment-index="0"
                    style="position: absolute; top: 0; left: 0; width: 200px"
                  >
                    Data residuals <br />
                    $x_n - \mathbf{P} (\Pi \ast g_\theta(z))$
                  </div>
                  <div
                    class="col fragment"
                    data-fragment-index="1"
                    style="position: absolute; top: 0; left: 0; width: 200px"
                  >
                    Standard Deviation
                  </div>
                </div>
              </div>
            </div>
            <div class="fragment">
              $\Longrightarrow$
              <b class="alert"
                >Uncertainties are fully captured by the posterior</b
              >.
            </div>
          </section>

          <section>
            <h3 class="slide-title" style="position: absolute; top: 0">
              Example: gravitational shear inference
            </h3>
            <div class="container">
              <div class="col">
                <div style="float: right; font-size: 20px">
                  Remy, <b>Lanusse</b>, Starck (2022)
                  <a href="https://arxiv.org/abs/2210.16243"
                    ><img
                      src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2210.16243-B31B1B.svg"
                      class="plain"
                      style="height: 25px; vertical-align: middle"
                  /></a>
                </div>
              </div>
            </div>
            <img
              class="plain"
              data-src="/talks/assets/great.jpg"
              style="height: 300px"
            />
            &nbsp; &nbsp; &nbsp;
            <img
              class="plain fragment"
              data-src="/talks/assets/model_shear.png"
              style="height: 300px"
            />

            <div class="container">
              <!-- <div class="col r-stack"> -->
              <div class="fragment">
                <img
                  data-src="/talks/assets/fit_generative_model.png"
                  class="plain"
                  style="height: 300px"
                />
                <!-- </div> -->

                <!-- <div class="col r-stack"> -->

                <img
                  data-src="/talks/assets/shear_estimate_nobias.png"
                  class="plain"
                  style="height: 300px"
                />
              </div>
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
              <div class="fragment">
                <img
                  data-src="/talks/assets/shear_estimate_bias.png"
                  class="plain"
                  style="height: 300px"
                />

                <img
                  data-src="/talks/assets/fit_sersic.png"
                  class="plain"
                  style="height: 300px"
                />
              </div>
            </div>
          </section>
        </section>

        <section>
          <section>
            <h3 class="slide-title">Discussion time</h3>

            <div class="container">
              <div class="col">
                <ul>
                  <li class="fragment" data-fragment-index="0">
                    <b
                      >Where are my hyper parameters, lambdas, regularizers,
                      etc?</b
                    ><br />
                    $\Longrightarrow$ There are none!<br /><b class="alert"
                      >Everything is determined by the physical model.</b
                    >
                  </li>
                  <br />
                  <br />
                  <li class="fragment" data-fragment-index="1">
                    <b
                      >You haven't told us how you solve these problems in
                      practice!</b
                    ><br />
                    $\Longrightarrow$ Problem statement vs implementation.<br />
                    <b class="alert">Practical methodologies already exist</b>,
                    and will only get better with time.
                  </li>
                  <br />
                  <br />
                  <li class="fragment" data-fragment-index="2">
                    Additional important technical considerations <br />
                    $\Longrightarrow$
                    <b class="alert">Automatically differentiable physics!</b>
                  </li>
                </ul>
              </div>

              <div class="col r-stack">
                <div class="fragment current-visible" data-fragment-index="0">
                  <img
                    data-src="/talks/assets/pgm.png"
                    class="plain"
                    style="height: 250px"
                  />
                  $$\log p(z | x) = -\frac{1}{2} || \Sigma^{-1/2} \left( x -
                  \mathbf{P} (\Pi \ast g_\theta(z)) \right) ||^2_2 - \frac{1}{2}
                  || z ||_2^2 + cst $$
                </div>

                <div class="fragment current-visible" data-fragment-index="1">
                  Variety of techniques:
                  <br />
                  <ul>
                    <li>
                      <b>Generative Modeling</b>: Normalizing Flow, PixelCNN,
                      GAN, <b>Diffusion Model</b>, etc...
                    </li>
                    <br />
                    <li>
                      <b>Inference</b>: Amortized Variational Inference,
                      <b>Annealed Langevin Sampling</b>, Hamiltonian
                      Monte-Carlo, etc...
                    </li>
                  </ul>
                  <br />
                  <br />
                  <div class="container">
                    <div class="col">
                      <img
                        height="200px;"
                        data-src="/talks/assets/benjamin.png"
                      /><br />
                      <b>Benjamin's poster</b> <br />
                      <em
                        >Sampling high-dimensional inverse problem posteriors
                        with neural score estimation</em
                      >
                    </div>
                    <div class="col">
                      <img
                        height="200px;"
                        data-src="https://ml4astro.github.io/icml2022/assets/Levasseur_Laurence-509x676.jpg"
                      /><br />
                      <b>Laurence's talk</b> <br />
                      <em
                        >Data-driven analysis of strong gravitational lenses:
                        opportunities and challenges for ml</em
                      >
                    </div>
                  </div>
                </div>

                <div class="fragment" data-fragment-index="2">
                  <div>
                    <img
                      data-src="/talks/assets/TF_FullColor_Horizontal.png"
                      style="height: 75px"
                    />
                    <img
                      style="height: 75px"
                      data-src="https://raw.githubusercontent.com/google/jax/master/images/jax_logo_250px.png"
                      class="plain"
                    />
                  </div>
                  <div class="r-stack">
                    <img data-src="/talks/assets/flowpm.gif" />

                    <div class="container fragment">
                      <div class="col">
                        <img
                          height="200px;"
                          data-src="https://people.epfl.ch/private/common/photos/links/223893.jpg?ts=1675862267"
                        /><br />
                        <b>Aymeric's talk</b> <br />
                        <em
                          >Multiscale modeling of galaxy-scale strong lenses</em
                        >
                      </div>
                      <div class="col">
                        <img
                          height="200px;"
                          data-src="http://www.jasonmcewen.org/authors/tobias-liaudat/avatar_hu3bff4568323d977a256d1b9aca489223_22663_250x250_fill_q90_lanczos_center.jpeg"
                        /><br />
                        <b>Tobias's talk</b> <br />
                        <em>
                          Rethinking data-driven point spread function modeling
                          with a differentiable optical model</em
                        >
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- 
          - no questions about regularizers, no hyper parameters, no lambda, no k-sigma
          
          - So far, I haven't mentioned methodologies required to pull this of
            - Amortized Variational Inference, Neural Score Matching, Generative Modeling, etc.
            Annelead Langevin Sampling
            - Why? Because my main message is about the approach, not the implementation

          - There are technical considerations 
            -> Automatic Differentation Frameworks, Probabilistic Programming Libraries and Languages

          - Generative Models as the Key to manipulate Implicit Distributions

             -->
          </section>

          <section>
            <h3 class="slide-title">Other examples of Deep Priors</h3>
            <br />
            <div class="container">
              <div class="col">
                <ul>
                  <li>
                    <em
                      >Hybrid Physical-Deep Learning Model for Astronomical
                      Inverse Problems</em
                    ><br />
                    <b> F. Lanusse</b>, P. Melchior, F. Moolekamp<br />
                    <a href="https://arxiv.org/abs/1912.03980"
                      ><img
                        src="https://img.shields.io/badge/astro--ph.IM-arXiv%3A1912.03980-B31B1B.svg"
                        class="plain"
                        style="height: 25px"
                    /></a>
                    <a href="https://www.youtube.com/watch?v=oWOU3qNHoL0"
                      ><img
                        src="https://img.shields.io/badge/-youtube-red?logo=youtube&labelColor=grey"
                        class="plain"
                        style="height: 25px"
                    /></a>
                  </li>
                </ul>
                <br />
                <br />
                $\mathcal{L} = \frac{1}{2} \parallel \mathbf{\Sigma}^{-1/2} (\ Y
                - P \ast A S \ ) \parallel_2^2 - \sum_{i=1}^K \log
                p_{\theta}(S_i)$
                <br />
                <br />
                <img class="plain" data-src="/talks/assets/scarlet_hsc.png" />
                <br />
                <br />
              </div>
              <div class="col fragment">
                <ul>
                  <li>
                    <em
                      >Denoising Score-Matching for Uncertainty Quantification
                      in Inverse Problems</em
                    ><br />
                    Z. Ramzi, B. Remy, <b>F. Lanusse</b>, P. Ciuciu, J.L.
                    Starck<br />
                    <a href="https://arxiv.org/abs/2011.08698"
                      ><img
                        src="https://img.shields.io/badge/stat.ML-arXiv%3A2011.08698-B31B1B.svg"
                        class="plain"
                        style="height: 25px"
                    /></a>
                  </li>
                </ul>
                <img
                  class="plain"
                  data-src="/talks/assets/knee.gif"
                  style="height: 410px"
                />
              </div>
            </div>
          </section>
        </section>

        <section>
          <h2>Physical Constraints on Neural Networks</h2>
          <hr />
        </section>

        <section>
          <h3 class="slide-title">
            3 Axes of Physics Informed Neural Networks
          </h3>

          <b>Problem statement:</b> Despite the problem being well defined
          (correct loss function, correct training set, etc.), a
          <b class="alert"
            >neural network $f_\theta$ may fail to achieve the optimum
            $f_{\theta^\star}$</b
          >.

          <br />
          <div class="block fragment" data-fragment-index="0">
            <div class="block-title">
              How to imbue physics into your neural network model?
            </div>
            <div class="block-content">
              <ul>
                <li class="fragment" data-fragment-index="1">
                  <b>Learning residuals</b>: If you can have a
                  <b class="alert"
                    >fast approximate physically motivated solution</b
                  >, use it!
                </li>
                <br />
                <li class="fragment" data-fragment-index="2">
                  <b>Loss function</b>: If you can constrain the parameter space
                  by <b class="alert">adding physically motivated penalties</b>,
                  do it!<br />
                  $\Longrightarrow$ When the penalties are based on PDEs, they
                  are called Physics Informed Neural Networks (PINNs).
                </li>
                <br />
                <li class="fragment" data-fragment-index="3">
                  <b>Physically motivated architectures</b>: If your neural
                  network should respect some
                  <b class="alert"
                    >symmetries, equivariances, or manifold constraints</b
                  >, hardcode these properties.
                </li>
              </ul>
            </div>
          </div>

          <div class="container">
            <div class="col fragment" data-fragment-index="1">
              <img
                height="150px;"
                data-src="https://people.epfl.ch/private/common/photos/links/344492.jpg?ts=1675865389"
              /><br />
              <b>Utsav's poster</b> <br />
              <em>Deep Learning-based galaxy image deconvolution</em>
            </div>

            <div class="col fragment" data-fragment-index="2">
              <img
                height="150px;"
                data-src="https://media.licdn.com/dms/image/D4E03AQGfKuhXpPPGvw/profile-displayphoto-shrink_800_800/0/1668396969352?e=2147483647&v=beta&t=zUpfIefwFohk7m0eRLcKYyPpUREVzZcaWIIzXJdcEEM"
              /><br />
              <b>Ayoub's poster</b> <br />
              <em
                >Delensing Gravitational Lensing Effects with Physics-Informed
                Neural Networks</em
              >
            </div>

            <div class="col fragment" data-fragment-index="3">
              <img
                height="150px;"
                data-src="https://cosmo.nyu.edu/ksf/images/headshot.jpg"
              /><br />
              <b>Kate's talk</b> <br />
              <em
                >Learning the Galaxy-Halo Connection by Imposing Exact Physical
                Symmetries</em
              >
            </div>

            <div class="col fragment" data-fragment-index="3">
              <img
                height="150px;"
                data-src="http://www.jasonmcewen.org/authors/admin/avatar_hu535661bce2c742bf7a0f6a055ac0b6d1_1603872_250x250_fill_q90_lanczos_center.jpg"
              /><br />
              <b>Jason's poster</b> <br />
              <em
                >Scalable and equivariant spherical CNNs by discrete-continuous
                (DISCO) convolutions</em
              >
            </div>
          </div>
        </section>

        <section>
          <h2>Hybrid Physical-Neural ODEs for Fast N-body Simulations</h2>
          <a href="https://arxiv.org/abs/2207.05509"
            ><img
              src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2207.05509-B31B1B.svg"
              class="plain"
              style="height: 25px"
          /></a>
          <hr />
          <div class="container">
            <div class="col">
              <div align="left" style="margin-left: 20px">
                <h3>Work led by Denise Lanzieri</h3>
                <img
                  data-src="https://avatars.githubusercontent.com/u/72620117?v=4"
                  style="width: 200px; height: 200px"
                />

                <br />

                $\Longrightarrow$
                <b class="alert">Learn residuals to known physical equations</b>
                to improve accuracy of fast Particle-Mesh simulations.
              </div>
            </div>
            <div class="col">
              <img
                class="plain"
                data-src="/talks/assets/cluster_2D_PM_NN.png"
                style="width: 450px"
              />
            </div>
          </div>
          <br />
        </section>

        <!-- <section
          data-background-iframe="https://www.youtube.com/embed/YjUICiYlCYE?autoplay=1&iv_load_policy=3&controls=0&disablekb=1&loop=1"
        >
          <h3 class="slide-title">Cosmological Simulations</h3>

          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />

          <div style="float: right; font-size: 16px">credit: Y. Feng</div>
        </section> -->

        <section>
          <h3 class="slide-title">You can try to learn the simulation...</h3>
          <div style="float: right; font-size: 25px">
            Learning particle displacement with a UNet. S. He, et al. (2019)
          </div>
          <br /><br />

          <img
            data-src="/talks/assets/Model-Comparison.jpg"
            style="height: 400px"
          />

          <div class="block fragment">
            <div class="block-title">
              The issue with using deep learning as a <i>black-box</i>
            </div>
            <div class="block-content">
              <ul>
                <li>No guarantees to work outside of training regime.</li>
                <li>
                  No guarantees to capture dependence on cosmology accurately.
                </li>
              </ul>
            </div>
          </div>
        </section>

        <section>
          <h3 class="slide-title">
            Bridging the gap between accuracy and speed
          </h3>
          <div class="r-stack">
            <div class="container">
              <div class="col">
                <p>Full N-body simulation</p>
                <img data-src="/talks/assets/cluster_2D_Camels.png" />
              </div>

              <div class="col">
                <p>Fast Particle-Mesh simulation</p>
                <img data-src="/talks/assets/cluster_2D_PM.png" />
              </div>
            </div>
            <img
              class="fragment"
              data-src="/talks/assets/comparison_pk_intro.png"
              class="plain"
              style="height: 500px"
            />
          </div>
        </section>

        <section>
          <section>
            <h3 class="slide-title">
              Augment the physical equations with a neural network
            </h3>
            <br /><br />
            We compute the time integration from a system of ordinary
            differential equations (ODE) $$\left\{ \begin{array}{ll} \frac{d
            \color{#6699CC}{\mathbf{x}} }{d a} & = \frac{1}{a^3 E(a)}
            \color{#6699CC}{\mathbf{v}} \\ \frac{d
            \color{#6699CC}{\mathbf{v}}}{d a} & = \frac{1}{a^2 E(a)} F_\theta(
            \color{#6699CC}{\mathbf{x}} , a), \\ F_\theta(
            \color{#6699CC}{\mathbf{x}}, a) &= \frac{3 \Omega_m}{2} \nabla
            \left[ \color{#669900}{\phi_{PM}} (\color{#6699CC}{\mathbf{x}})
            \right] \end{array} \right. $$
            <ul>
              <li>
                <span style="color: #6699cc">$\mathbf{x}$</span> and
                <span style="color: #6699cc">$\mathbf{v}$</span> define the
                position and the velocity of the particles
              </li>
              <li>
                <span style="color: #669900">$\phi_{PM}$</span> is the
                gravitational potential in the mesh
              </li>
            </ul>
            <br />
            <p class="fragment" data-fragment-index="1">
              $\to$ We can use this parametrisation to complement the physical
              ODE with neural networks.
            </p>
            <br />
            <p class="fragment" data-fragment-index="1">
              $$F_\theta(\mathbf{x}, a) = \frac{3 \Omega_m}{2} \nabla \left[
              \phi_{PM} (\mathbf{x}) \ast \mathcal{F}^{-1} (1 +
              \color{#996699}{f_\theta(a,|\mathbf{k}|)}) \right] $$
            </p>
            <br />
            <div
              class="fragment"
              data-fragment-index="1"
              style="position: relative; top: 0px"
            >
              Correction integrated as a Fourier-based isotropic filter
              <span style="color: #996699">$f_{\theta}$</span> $\to$
              incorporates <b>translation and rotation symmetries</b>
            </div>
          </section>

          <section>
            <h3 class="slide-title">Learn the Neural Filter</h3>
            <ul>
              <li>
                <span style="color: #996699">$f_{\theta}(a)$</span> is defined
                as B-spline functions whose coefficients are the output of the
                Neural Network of parameters $\theta$.
              </li>
            </ul>
            <div>
              <img
                data-src="/talks/assets/nn_manim.png"
                class="plain"
                style="height: 600px; width: 950px"
              />
            </div>
          </section>
          <section>
            <h3 class="slide-title">Train and validation loss</h3>
            <div class="container">
              <div class="col">
                <div>
                  $$\mathcal{L} = \sum_{i}^{snapshots} \lambda_1||
                  \color{#6699CC}{\mathbf{x}^{ref}_i} -
                  \color{#6699CC}{\mathbf{x}_i}||_2^2 + \lambda_2 ||
                  \frac{\color{#996699}{p_i(k)}}{\color{#996699}{p_i^{ref}(k)}}
                  -1 ||_2^2 $$
                </div>
              </div>
              <div class="col">
                <ul>
                  <li>
                    We adopt a loss function penalizing both the
                    <span style="color: #6699cc">particle positions</span> and
                    the overall
                    <span style="color: #996699">matter power spectrum</span> at
                    different snapshot times
                  </li>
                  <br />
                  <li>
                    We train and compare the model to the CAMELS simulations
                    <a
                      style="color: #GOLD"
                      ;
                      href=" https://arxiv.org/pdf/2010.00619.pdf:"
                      >(Villaescusa-Navarro et al., 2021)
                    </a>
                  </li>
                  <br />
                  <li>
                    We use a single N-body simulation of $25^3$ ($h^{-1}$
                    Mpc)$^3$ volume, $64^3$ dark matter particles at the
                    fiducial cosmology of $\Omega_m = 0.3$ and $\sigma_8 = 0.8$
                  </li>
                  <br />
                  <li>
                    Whole code implemented in the Python package
                    <span style="color: #669900">Jax</span>.
                  </li>
                </ul>
              </div>
            </div>
          </section>

          <section>
            <h3 class="slide-title">Backpropagation through the ODE solver</h3>
            We are following the technique from Neural ODEs to
            <b>backpropagate through an ODE solver</b> (<a
              style="color: #ffaa7f; font-size: 20px"
              href="https://proceedings.neurips.cc/paper/2018/file/69386f6bb1dfed68692a24c8686939b9-Paper.pdf"
              >Neural Ordinary Differential Equations, Chen et al. 2018</a
            >). <br /><br />
            <!-- <li> $\to$ Treat the ODE solver as a black box and compute gradients using the adjoint sensitivity method (Pontryagin et al., 1962).
            </li> -->
            <div class="block">
              <div class="block-title" style="color: white">
                How optimize a
                <span style="color: #6699cc">loss function</span> with input the
                result of an ODE solver:
                <span style="color: #6699cc">$\textbf{L}$</span
                >(ODESolve$(\color{#996699}{z}(t_0),f,t_0,t_1,\color{#ecad60}{\theta}))$?
              </div>
              <div class="block-content">
                <br />
                To optimize <span style="color: #6699cc">$\textbf{L}$</span>, we
                require gradients with respect to
                <span style="color: #ecad60">$\theta$</span>:
                <ul>
                  <ol>
                    <br />
                    <li class="fragment" data-fragment-index="0">
                      Determine how the gradient of the loss (the
                      <span style="color: #669900">adjoint</span>) depends on
                      the hidden state
                      <span style="color: #996699">$z$</span>(t) at each
                      instant: $$\color{#669900}{\textbf{a}}(t)=\frac{\partial
                      \color{#6699CC}{L}}{\partial
                      \color{#996699}{\textbf{z}}(t)}$$
                    </li>
                    <li class="fragment" data-fragment-index="1">
                      Compute the
                      <span style="color: #669900">adjoint</span> dynamics by
                      solving a another ODE: $$
                      \frac{d\color{#669900}{\textbf{a}}(t)}{dt}=\color{#669900}{\textbf{a}}(t)^{T}\frac{\partial
                      f(\color{#996699}{\textbf{z}}(t),t,\color{#ecad60}{\theta})}{\partial
                      \color{#996699}{\textbf{z}}} $$
                    </li>
                    <li class="fragment" data-fragment-index="2">
                      Compute the gradients with respect to the parameters
                      $\theta$ evaluating a third integral: $$
                      \frac{d\color{#6699CC}{L}}{d\color{#ecad60}{\theta}}=\int_{t_1}^{t_0}\color{#669900}{\textbf{a}}(t)^T
                      \frac{\partial f
                      (\color{#996699}{\textbf{z}}(t),t,\theta)}{\partial
                      \color{#ecad60}{\theta}}dt $$
                    </li>
                  </ol>
                </ul>
              </div>
            </div>
          </section>
        </section>

        <section>
          <section>
            <h3 class="slide-title">Hybrid Physical-Neural ODE Simulation</h3>
            <br />
            <br />
            <div class="container">
              <div class="col">
                <div class="block-content">
                  <div
                    style="position:relative; height:570px; width:700px top:0px; left:0px;"
                  >
                    Camels simulations
                    <img
                      data-src="/talks/assets/cluster_2D_Camels.png"
                      style="height: 400px; width: 1500px"
                    />
                  </div>
                </div>
              </div>
              <div class="col">
                <div class="block-content">
                  <div
                    style="
                      position: relative;
                      height: 570px;
                      top: 0px;
                      left: 0px;
                    "
                  >
                    <div
                      class="plain fragment current-visible"
                      style="position: absolute; top: 0; left: 0; width: 600px"
                      data-fragment-index="0"
                    >
                      PM simulations
                      <img
                        data-src="/talks/assets/cluster_2D_PM.png"
                        style="height: 400px"
                      />
                    </div>

                    <div
                      class="plain fragment current-visible"
                      style="position: absolute; top: 0; left: 0; width: 600px"
                      data-fragment-index="1"
                    >
                      PM+NN correction
                      <img
                        data-src="/talks/assets/cluster_2D_PM_NN.png"
                        style="height: 400px"
                      />
                    </div>

                    <!-- <div
                      class="plain fragment current-visible"
                      style="position: absolute; top: 0; left: 0; width: 600px"
                      data-fragment-index="2"
                    >
                      PM+PGD correction
                      <img
                        data-src="/talks/assets/cluster_2D_PM_PGD.png"
                        style="height: 400px"
                      />
                    </div> -->
                  </div>
                </div>
              </div>
            </div>
          </section>
          <section>
            <div class="container">
              <div class="col">
                <img data-src="/talks/assets/comparison_pk_without.png" />
                <br />
                Without neural correction
              </div>
              <div class="col">
                <img data-src="/talks/assets/comparison_pk_with.png" />
                <br />
                With neural correction
              </div>
            </div>
          </section>

          <section>
            <h3 class="slide-title">
              Results: Robustness to changes in resolution and cosmological
              parameters
            </h3>
            <br />
            <div>
              <li>
                Netural network trained using single CAMELS simulation of
                <span style="color: #996699"
                  >$25^3$ ($h^{-1}$ Mpc)$^3$ volume</span
                >
                and
                <span style="color: #669900">$64^3$ dark matter particles</span>
                at the fiducial cosmology of
                <span style="color: #6699cc">$\Omega_m = 0.3$</span>
              </li>
            </div>
            <br /><br />
            <div class="container">
              <div class="col">
                <img
                  data-src="/talks/assets/camels_residual_diff_resolution_CV_0.png"
                />
                <br />
                Higher resolution
              </div>
              <!-- <div class="col">
                <img
                  data-src="/talks/assets/halofit_residuals_wrong_boxsize_res.png"
                />
                <br />
                Lower resolution
              </div> -->
              <div class="col">
                <img
                  data-src="/talks/assets/camels_residual_diffomega_1P_1_n5.png"
                />
                <br />
                Different Cosmology
              </div>
            </div>
          </section>
        </section>

        <section>
          <h2>Conclusion</h2>
          <hr />
        </section>

        <section>
          <h3 class="slide-title">Conclusion</h3>
          <div class="block">
            <div class="block-title">
              Convergence of Physical Models and Machine Learning
            </div>
            <div class="block-content">
              <br />
              <ul>
                <li>
                  Generative modeling and modern inference techniques make
                  <b class="alert">Physical Bayesian inference possible</b> at
                  scale and with non-trivial models!
                </li>
                <br />
                <li>
                  Incorporating
                  <b class="alert">physical constraints bring robustness</b>.
                </li>
                <br />
              </ul>
            </div>
          </div>
          <br />

          <div class="fragment">
            <b>Pre-emptive advertisement</b>: We are submitting an
            <b>ICML 2023 workshop proposal</b> on Machine Learning for Astro, on
            <b>overcoming the challenges of Machine Learning for Physics</b>
            <br />
            <br />
            <a href="https://ml4astro.github.io/icml2022">
              https://ml4astro.github.io/icml2022</a
            >
          </div>

          <br />
          <p class="fragment">Thank you, and enjoy the rest of the session!</p>
          <br />
          <br />
          <br />
        </section>
      </div>
    </div>

    <style>
      /* .reveal .slides {
        border: 5px solid red;
        min-height: 100%;
        width: 128mm;
        height: 96mm;
      } */

      .reveal .block {
        background-color: #191919;
        margin-left: 20px;
        margin-right: 20px;
        text-align: left;
        padding-bottom: 0.1em;
      }

      .reveal .block-title {
        background-color: #333333;
        padding: 8px 35px 8px 14px;
        color: #ffaa7f;
        font-weight: bold;
      }

      .reveal .block-content {
        padding: 8px 35px 8px 14px;
      }

      .reveal .slide-title {
        border-left: 5px solid white;
        text-align: left;
        margin-left: 20px;
        padding-left: 20px;
      }

      .reveal .alert {
        color: #ffaa7f;
        font-weight: bold;
      }

      .reveal .inverted {
        filter: invert(100%);
      }
    </style>

    <script src="reveal.js/dist/reveal.js"></script>
    <script src="reveal.js/plugin/notes/notes.js"></script>
    <script src="reveal.js/plugin/markdown/markdown.js"></script>
    <script src="reveal.js/plugin/highlight/highlight.js"></script>
    <script src="reveal.js/plugin/math/math.js"></script>
    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
        controls: true,

        //center: false,
        hash: true,

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: "hidden",

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: true,

        transition: "slide", // none/fade/slide/convex/concave/zoom

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,
        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // Bounds for smallest/largest possible scale to apply to content
        minScale: 0.2,
        maxScale: 1.5,

        autoPlayMedia: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes, RevealMath],

        dependencies: [
          {
            src: "reveal.js/plugin/markdown/marked.js",
          },
          {
            src: "reveal.js/plugin/markdown/markdown.js",
          },
          {
            src: "reveal.js/plugin/notes/notes.js",
            async: true,
          },
          {
            src: "reveal.js/plugin/math/math.js",
            async: true,
          },
          {
            src: "reveal.js/plugin/reveal.js-d3/reveald3.js",
          },
          {
            src: "reveal.js/plugin/reveal.js-plugins/chart/Chart.min.js",
          },
          {
            src: "reveal.js/plugin/reveal.js-plugins/chart/csv2chart.js",
          },
          {
            src: "reveal.js/plugin/highlight/highlight.js",
            async: true,
          },
        ],
      });
    </script>
  </body>
</html>
